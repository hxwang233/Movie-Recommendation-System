{"remainingRequest":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\user\\MsgPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\user\\MsgPage.vue","mtime":1614739926557},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CglNb2RhbAp9IGZyb20gJ2FudC1kZXNpZ24tdnVlJzsKaW1wb3J0IHsKCW1hcE11dGF0aW9ucywKCW1hcFN0YXRlCn0gZnJvbSAidnVleCI7CmV4cG9ydCBkZWZhdWx0IHsKCXByb3BzOiBbJ21vcGVuJywgJ21zZ051bSddLAoJYXN5bmMgY3JlYXRlZCgpIHsKCQl0aGlzLmFsbE1zZygpOwoJCWlmICh0aGlzLm1zZ051bSA9PSAwKSB7CgkJCXRoaXMuYnV0dG9uVXNhYmxlID0gZmFsc2U7CgkJfSBlbHNlIHsKCQkJdGhpcy5idXR0b25Vc2FibGUgPSB0cnVlOwoJCX0KCQl0aGlzLnZpc2libGUgPSBtb3BlbjsJCQoJfSwKCWNvbXB1dGVkOiB7CgkJLi4ubWFwU3RhdGUoWydyZXF1ZXN0UGF0aCcsICd1c2VySW5mbyddKSwKCX0sCglkYXRhKCkgewoJCXJldHVybiB7CgkJCWJ1dHRvblVzYWJsZTogdHJ1ZSwKCQkJdmlzaWJsZTogZmFsc2UsCgkJCWNoaWxkcmVuRHJhd2VyOiBmYWxzZSwKCQkJbXNnOiB7CgkJCQlhZG1pbk5hbWU6ICdBbnQgRGVzaWduIFRpdGxlIDEnLAoJCQkJaGVhZFBpYzogJ2RlZmF1bHQuanBnJywKCQkJCWNvbnRlbnQ6ICdlbmVubmVuZW5lbmVuZScsCgkJCQljcmVhdGVkVGltZTogJzIwMjAtMS0xJywKCQkJCWhhc1JlYWQ6IDAsCgkJCX0sCgkJCWRhdGFTb3VyY2U6IG51bGwsCgkJfTsKCX0sCgltZXRob2RzOiB7CgkJYXN5bmMgYWxsTXNnKCkgewoJCQlsZXQgewoJCQkJZGF0YQoJCQl9ID0gYXdhaXQgdGhpcy4kZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RQYXRoICsgJ2J1bGxldGluL3VzZXIvJyArIHRoaXMudXNlckluZm8udWlkKTsKCQkJaWYgKGRhdGEuY29kZSA9PSAwKSB7CgkJCQl0aGlzLmRhdGFTb3VyY2UgPSBkYXRhLmRhdGE7CgkJCX0KCQl9LAoJCWFzeW5jIGFsbFJlYWQoKSB7CgkJCWxldCB7CgkJCQlkYXRhCgkJCX0gPSBhd2FpdCB0aGlzLiRnZXQodGhpcy4kc3RvcmUuc3RhdGUucmVxdWVzdFBhdGggKyAnYnVsbGV0aW4vdXNlci9yZWFkX2FsbC8nICsgdGhpcy51c2VySW5mby51aWQpOwoJCQlpZiAoZGF0YS5jb2RlID09IDApIHsKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhU291cmNlLmxlbmd0aDsgaSsrKSB7CgkJCQkJdGhpcy5kYXRhU291cmNlW2ldLmhhc1JlYWQgPSAxOwoJCQkJfQoJCQkJdGhpcy5idXR0b25Vc2FibGUgPSBmYWxzZTsKCQkJfQoJCX0sCgkJYXN5bmMgcmVhZFRoaXMoKSB7CgkJCWxldCBwYXJhbXMgPSB7CgkJCQl1aWQ6IHRoaXMudXNlckluZm8udWlkLAoJCQkJYmlkOiB0aGlzLm1zZy5pZCwKCQkJfTsKCQkJbGV0IHsKCQkJCWRhdGEKCQkJfSA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCh0aGlzLiRzdG9yZS5zdGF0ZS5yZXF1ZXN0UGF0aCArICdidWxsZXRpbi91c2VyL3JlYWRfdGhpcycgLCBwYXJhbXMpOwoJCX0sIAoJCXNob3dEcmF3ZXIoKSB7CgkJCXRoaXMudmlzaWJsZSA9IHRydWU7CgkJfSwKCQlvbkNsb3NlKCkgewoJCQl0aGlzLiRlbWl0KCJjbG9zZU1zZ1dpbmRvdyIpOwoJCQl0aGlzLnZpc2libGUgPSBmYWxzZTsKCQl9LAoJCXNob3dDaGlsZHJlbldpbmRvdyhpdGVtKSB7CgkJCXRoaXMubXNnID0gaXRlbTsKCQkJdGhpcy5jaGlsZHJlbkRyYXdlciA9IHRydWU7CgkJCXRoaXMucmVhZFRoaXMoKTsKCQl9LAoJCWhhbmRsZU9rKGUpIHsKCQkJdGhpcy5jaGlsZHJlbkRyYXdlciA9IGZhbHNlOwoJCQl0aGlzLmFsbE1zZygpOwoJCX0sCgkJaGFuZGxlQ2FuY2VsKGUpewoJCQl0aGlzLmNoaWxkcmVuRHJhd2VyID0gZmFsc2U7CgkJCXRoaXMuYWxsTXNnKCk7CgkJfQoJfSwKfTsK"},{"version":3,"sources":["MsgPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MsgPage.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<a-drawer title=\"我的消息\" width=\"520\" :closable=\"false\" :visible=\"visible\" @close=\"onClose\">\r\n\t\t\t<a-list item-layout=\"horizontal\" :data-source=\"dataSource\">\r\n\t\t\t\t<a-list-item slot=\"renderItem\" slot-scope=\"item, index\">\r\n\t\t\t\t\t<a-list-item-meta :description=\"item.content\">\r\n\t\t\t\t\t\t<a slot=\"title\" @click=\"showChildrenWindow(item)\">{{ item.adminName }}</a>\r\n\t\t\t\t\t\t<a-avatar slot=\"avatar\" :src=\"requestPath + 'userpic/' + item.headPic\" />\r\n\t\t\t\t\t</a-list-item-meta>\r\n\t\t\t\t\t<a slot=\"actions\" v-if=\"item.hasRead==0\">标为已读</a>\r\n\t\t\t\t\t<span slot=\"actions\" v-else>已读</span>\r\n\t\t\t\t</a-list-item>\r\n\t\t\t</a-list>\r\n\t\t\t<a-divider />\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<a-button type=\"primary\" @click=\"allRead\" :disabled=\"!buttonUsable\">\r\n\t\t\t\t\t全部已读\r\n\t\t\t\t</a-button>\r\n\t\t\t</div>\r\n\t\t\t<a-modal v-model=\"childrenDrawer\" title=\"信息详情\" @ok=\"handleOk\" @cancel=\"handleCancel\">\r\n\t\t\t\t<p style=\"font-size: 16px;\" v-if=\"msg.adminEmail\"> From: {{msg.adminName}} ({{msg.adminEmail}})</p>\r\n\t\t\t\t<p style=\"font-size: 16px;\" v-else> From: {{msg.adminName}}</p>\r\n\t\t\t\t<p style=\"font-size: 16px;\"> Time: {{msg.createdTime}}</p>\r\n\t\t\t\t<p style=\"font-size: 16px;\"> Msg: {{msg.content}}</p>\r\n\t\t\t</a-modal>\r\n\t\t</a-drawer>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tModal\r\n\t} from 'ant-design-vue';\r\n\timport {\r\n\t\tmapMutations,\r\n\t\tmapState\r\n\t} from \"vuex\";\r\n\texport default {\r\n\t\tprops: ['mopen', 'msgNum'],\r\n\t\tasync created() {\r\n\t\t\tthis.allMsg();\r\n\t\t\tif (this.msgNum == 0) {\r\n\t\t\t\tthis.buttonUsable = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.buttonUsable = true;\r\n\t\t\t}\r\n\t\t\tthis.visible = mopen;\t\t\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['requestPath', 'userInfo']),\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tbuttonUsable: true,\r\n\t\t\t\tvisible: false,\r\n\t\t\t\tchildrenDrawer: false,\r\n\t\t\t\tmsg: {\r\n\t\t\t\t\tadminName: 'Ant Design Title 1',\r\n\t\t\t\t\theadPic: 'default.jpg',\r\n\t\t\t\t\tcontent: 'enennenenenene',\r\n\t\t\t\t\tcreatedTime: '2020-1-1',\r\n\t\t\t\t\thasRead: 0,\r\n\t\t\t\t},\r\n\t\t\t\tdataSource: null,\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync allMsg() {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'bulletin/user/' + this.userInfo.uid);\r\n\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\tthis.dataSource = data.data;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync allRead() {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'bulletin/user/read_all/' + this.userInfo.uid);\r\n\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\tfor (var i = 0; i < this.dataSource.length; i++) {\r\n\t\t\t\t\t\tthis.dataSource[i].hasRead = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.buttonUsable = false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync readThis() {\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tuid: this.userInfo.uid,\r\n\t\t\t\t\tbid: this.msg.id,\r\n\t\t\t\t};\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.axios.post(this.$store.state.requestPath + 'bulletin/user/read_this' , params);\r\n\t\t\t}, \r\n\t\t\tshowDrawer() {\r\n\t\t\t\tthis.visible = true;\r\n\t\t\t},\r\n\t\t\tonClose() {\r\n\t\t\t\tthis.$emit(\"closeMsgWindow\");\r\n\t\t\t\tthis.visible = false;\r\n\t\t\t},\r\n\t\t\tshowChildrenWindow(item) {\r\n\t\t\t\tthis.msg = item;\r\n\t\t\t\tthis.childrenDrawer = true;\r\n\t\t\t\tthis.readThis();\r\n\t\t\t},\r\n\t\t\thandleOk(e) {\r\n\t\t\t\tthis.childrenDrawer = false;\r\n\t\t\t\tthis.allMsg();\r\n\t\t\t},\r\n\t\t\thandleCancel(e){\r\n\t\t\t\tthis.childrenDrawer = false;\r\n\t\t\t\tthis.allMsg();\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style>\r\n</style>\n"]}]}