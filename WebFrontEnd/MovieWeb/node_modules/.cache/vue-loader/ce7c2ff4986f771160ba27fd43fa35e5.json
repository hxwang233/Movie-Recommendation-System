{"remainingRequest":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\user\\MsgPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\user\\MsgPage.vue","mtime":1614425024941},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CglNb2RhbAp9IGZyb20gJ2FudC1kZXNpZ24tdnVlJzsKaW1wb3J0IHsKCW1hcE11dGF0aW9ucywKCW1hcFN0YXRlCn0gZnJvbSAidnVleCI7CmV4cG9ydCBkZWZhdWx0IHsKCXByb3BzOiBbJ29wZW4nLCAnbXNnTnVtJ10sCglhc3luYyBjcmVhdGVkKCkgewoJCXRoaXMuYWxsTXNnKCk7CgkJaWYgKHRoaXMubXNnTnVtID09IDApIHsKCQkJdGhpcy5idXR0b25Vc2FibGUgPSBmYWxzZTsKCQl9IGVsc2UgewoJCQl0aGlzLmJ1dHRvblVzYWJsZSA9IHRydWU7CgkJfQoJCXRoaXMudmlzaWJsZSA9IG9wZW47CQkKCX0sCgljb21wdXRlZDogewoJCS4uLm1hcFN0YXRlKFsncmVxdWVzdFBhdGgnLCAndXNlckluZm8nXSksCgl9LAoJZGF0YSgpIHsKCQlyZXR1cm4gewoJCQlidXR0b25Vc2FibGU6IHRydWUsCgkJCXZpc2libGU6IGZhbHNlLAoJCQljaGlsZHJlbkRyYXdlcjogZmFsc2UsCgkJCW1zZzogewoJCQkJYWRtaW5OYW1lOiAnQW50IERlc2lnbiBUaXRsZSAxJywKCQkJCWhlYWRQaWM6ICdkZWZhdWx0LmpwZycsCgkJCQljb250ZW50OiAnZW5lbm5lbmVuZW5lbmUnLAoJCQkJY3JlYXRlZFRpbWU6ICcyMDIwLTEtMScsCgkJCQloYXNSZWFkOiAwLAoJCQl9LAoJCQlkYXRhU291cmNlOiBudWxsLAoJCX07Cgl9LAoJbWV0aG9kczogewoJCWFzeW5jIGFsbE1zZygpIHsKCQkJbGV0IHsKCQkJCWRhdGEKCQkJfSA9IGF3YWl0IHRoaXMuJGdldCh0aGlzLiRzdG9yZS5zdGF0ZS5yZXF1ZXN0UGF0aCArICdidWxsZXRpbi91c2VyLycgKyB0aGlzLnVzZXJJbmZvLnVpZCk7CgkJCWlmIChkYXRhLmNvZGUgPT0gMCkgewoJCQkJdGhpcy5kYXRhU291cmNlID0gZGF0YS5kYXRhOwoJCQl9CgkJfSwKCQlhc3luYyBhbGxSZWFkKCkgewoJCQlsZXQgewoJCQkJZGF0YQoJCQl9ID0gYXdhaXQgdGhpcy4kZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RQYXRoICsgJ2J1bGxldGluL3VzZXIvcmVhZF9hbGwvJyArIHRoaXMudXNlckluZm8udWlkKTsKCQkJaWYgKGRhdGEuY29kZSA9PSAwKSB7CgkJCQlmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZGF0YVNvdXJjZS5sZW5ndGg7IGkrKykgewoJCQkJCXRoaXMuZGF0YVNvdXJjZVtpXS5oYXNSZWFkID0gMTsKCQkJCX0KCQkJCXRoaXMuYnV0dG9uVXNhYmxlID0gZmFsc2U7CgkJCX0KCQl9LAoJCWFzeW5jIHJlYWRUaGlzKCkgewoJCQlsZXQgcGFyYW1zID0gewoJCQkJdWlkOiB0aGlzLnVzZXJJbmZvLnVpZCwKCQkJCWJpZDogdGhpcy5tc2cuaWQsCgkJCX07CgkJCWxldCB7CgkJCQlkYXRhCgkJCX0gPSBhd2FpdCB0aGlzLmF4aW9zLnBvc3QodGhpcy4kc3RvcmUuc3RhdGUucmVxdWVzdFBhdGggKyAnYnVsbGV0aW4vdXNlci9yZWFkX3RoaXMnICwgcGFyYW1zKTsKCQl9LCAKCQlzaG93RHJhd2VyKCkgewoJCQl0aGlzLnZpc2libGUgPSB0cnVlOwoJCX0sCgkJb25DbG9zZSgpIHsKCQkJdGhpcy4kZW1pdCgiY2xvc2VNc2dXaW5kb3ciKTsKCQkJdGhpcy52aXNpYmxlID0gZmFsc2U7CgkJfSwKCQlzaG93Q2hpbGRyZW5XaW5kb3coaXRlbSkgewoJCQl0aGlzLm1zZyA9IGl0ZW07CgkJCXRoaXMuY2hpbGRyZW5EcmF3ZXIgPSB0cnVlOwoJCQl0aGlzLnJlYWRUaGlzKCk7CgkJfSwKCQloYW5kbGVPayhlKSB7CgkJCXRoaXMuY2hpbGRyZW5EcmF3ZXIgPSBmYWxzZTsKCQkJdGhpcy5hbGxNc2coKTsKCQl9LAoJCWhhbmRsZUNhbmNlbChlKXsKCQkJdGhpcy5jaGlsZHJlbkRyYXdlciA9IGZhbHNlOwoJCQl0aGlzLmFsbE1zZygpOwoJCX0KCX0sCn07Cg=="},{"version":3,"sources":["MsgPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MsgPage.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<a-drawer title=\"我的消息\" width=\"520\" :closable=\"false\" :visible=\"visible\" @close=\"onClose\">\r\n\t\t\t<a-list item-layout=\"horizontal\" :data-source=\"dataSource\">\r\n\t\t\t\t<a-list-item slot=\"renderItem\" slot-scope=\"item, index\">\r\n\t\t\t\t\t<a-list-item-meta :description=\"item.content\">\r\n\t\t\t\t\t\t<a slot=\"title\" @click=\"showChildrenWindow(item)\">{{ item.adminName }}</a>\r\n\t\t\t\t\t\t<a-avatar slot=\"avatar\" :src=\"requestPath + 'userpic/' + item.headPic\" />\r\n\t\t\t\t\t</a-list-item-meta>\r\n\t\t\t\t\t<a slot=\"actions\" v-if=\"item.hasRead==0\">标为已读</a>\r\n\t\t\t\t\t<span slot=\"actions\" v-else>已读</span>\r\n\t\t\t\t</a-list-item>\r\n\t\t\t</a-list>\r\n\t\t\t<a-divider />\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<a-button type=\"primary\" @click=\"allRead\" :disabled=\"!buttonUsable\">\r\n\t\t\t\t\t全部已读\r\n\t\t\t\t</a-button>\r\n\t\t\t</div>\r\n\t\t\t<a-modal v-model=\"childrenDrawer\" title=\"信息详情\" @ok=\"handleOk\" @cancel=\"handleCancel\">\r\n\t\t\t\t<p style=\"font-size: 16px;\" v-if=\"msg.adminEmail\"> From: {{msg.adminName}} ({{msg.adminEmail}})</p>\r\n\t\t\t\t<p style=\"font-size: 16px;\" v-else> From: {{msg.adminName}}</p>\r\n\t\t\t\t<p style=\"font-size: 16px;\"> Time: {{msg.createdTime}}</p>\r\n\t\t\t\t<p style=\"font-size: 16px;\"> Msg: {{msg.content}}</p>\r\n\t\t\t</a-modal>\r\n\t\t</a-drawer>\r\n\t\t<a-moddel>\r\n\r\n\t\t</a-moddel>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tModal\r\n\t} from 'ant-design-vue';\r\n\timport {\r\n\t\tmapMutations,\r\n\t\tmapState\r\n\t} from \"vuex\";\r\n\texport default {\r\n\t\tprops: ['open', 'msgNum'],\r\n\t\tasync created() {\r\n\t\t\tthis.allMsg();\r\n\t\t\tif (this.msgNum == 0) {\r\n\t\t\t\tthis.buttonUsable = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.buttonUsable = true;\r\n\t\t\t}\r\n\t\t\tthis.visible = open;\t\t\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['requestPath', 'userInfo']),\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tbuttonUsable: true,\r\n\t\t\t\tvisible: false,\r\n\t\t\t\tchildrenDrawer: false,\r\n\t\t\t\tmsg: {\r\n\t\t\t\t\tadminName: 'Ant Design Title 1',\r\n\t\t\t\t\theadPic: 'default.jpg',\r\n\t\t\t\t\tcontent: 'enennenenenene',\r\n\t\t\t\t\tcreatedTime: '2020-1-1',\r\n\t\t\t\t\thasRead: 0,\r\n\t\t\t\t},\r\n\t\t\t\tdataSource: null,\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync allMsg() {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'bulletin/user/' + this.userInfo.uid);\r\n\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\tthis.dataSource = data.data;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync allRead() {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'bulletin/user/read_all/' + this.userInfo.uid);\r\n\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\tfor (var i = 0; i < this.dataSource.length; i++) {\r\n\t\t\t\t\t\tthis.dataSource[i].hasRead = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.buttonUsable = false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync readThis() {\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tuid: this.userInfo.uid,\r\n\t\t\t\t\tbid: this.msg.id,\r\n\t\t\t\t};\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.axios.post(this.$store.state.requestPath + 'bulletin/user/read_this' , params);\r\n\t\t\t}, \r\n\t\t\tshowDrawer() {\r\n\t\t\t\tthis.visible = true;\r\n\t\t\t},\r\n\t\t\tonClose() {\r\n\t\t\t\tthis.$emit(\"closeMsgWindow\");\r\n\t\t\t\tthis.visible = false;\r\n\t\t\t},\r\n\t\t\tshowChildrenWindow(item) {\r\n\t\t\t\tthis.msg = item;\r\n\t\t\t\tthis.childrenDrawer = true;\r\n\t\t\t\tthis.readThis();\r\n\t\t\t},\r\n\t\t\thandleOk(e) {\r\n\t\t\t\tthis.childrenDrawer = false;\r\n\t\t\t\tthis.allMsg();\r\n\t\t\t},\r\n\t\t\thandleCancel(e){\r\n\t\t\t\tthis.childrenDrawer = false;\r\n\t\t\t\tthis.allMsg();\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style>\r\n</style>\n"]}]}