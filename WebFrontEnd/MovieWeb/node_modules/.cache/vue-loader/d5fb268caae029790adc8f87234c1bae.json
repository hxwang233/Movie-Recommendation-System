{"remainingRequest":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\MovieDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\MovieDetail.vue","mtime":1614257318858},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CgltYXBNdXRhdGlvbnMsCgltYXBTdGF0ZQp9IGZyb20gJ3Z1ZXgnCgpmdW5jdGlvbiBnZXRCYXNlNjQoaW1nLCBjYWxsYmFjaykgewoJY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCXJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4gY2FsbGJhY2socmVhZGVyLnJlc3VsdCkpOwoJcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1nKTsKfTsKZXhwb3J0IGRlZmF1bHQgewoJY29tcHV0ZWQ6IHsKCQkuLi5tYXBTdGF0ZShbJ3VzZXJJbmZvJywgJ3JlcXVlc3RQYXRoJ10pCgl9LAoJZGF0YSgpIHsKCQlyZXR1cm4gewoJCQlsYWJlbENvbDogewoJCQkJc3BhbjogNAoJCQl9LAoJCQl3cmFwcGVyQ29sOiB7CgkJCQlzcGFuOiAxNAoJCQl9LAoJCQlnZW5yZUxpc3Q6IFsn5Yqo5L2cJywgJ+WGkumZqScsICfliqjnlLsnLCAn5YS/56ulJywgJ+WWnOWJpycsICfniq/nvaonLCAn57qq5b2VJywgJ+aIj+WJpycsCgkJCQkn5bm75oOzJywgJ+m7keiJsicsICfmgZDmgJYnLCAn6Z+z5LmQJywgJ+elnuenmCcsICfmtarmvKsnLCAn56eR5bm7JywgJ+aDiuaCmicsICfmiJjkuoknLCAn6KW/6YOoJywgJ+WFtuS7licKCQkJXSwKCQkJcGljbG9hZGluZzogZmFsc2UsCgkJCW1vZGlmeTogZmFsc2UsCgkJCXZpc2libGU6IGZhbHNlLAoJCQlpbWFnZVVybDogJycsCgkJCWxhdGVzdEltYWdlVXJsOiBudWxsLAoJCQltb3ZpZTogbnVsbCwKCQl9OwoJfSwKCXByb3BzOiBbJ3JlY29yZCddLAoJYXN5bmMgY3JlYXRlZCgpIHsKCQlsZXQgewoJCQlkYXRhCgkJfSA9IGF3YWl0IHRoaXMuJGdldCh0aGlzLiRzdG9yZS5zdGF0ZS5yZXF1ZXN0UGF0aCArICdtb3ZpZS8nICsgdGhpcy5yZWNvcmQubWlkKTsKCQl0aGlzLm1vdmllID0gZGF0YTsKCQl0aGlzLmltYWdlVXJsID0gdGhpcy5yZXF1ZXN0UGF0aCArICdtb3ZpZXBvc3Rlci8nICsgZGF0YS5waWM7CgkJdGhpcy5sYXRlc3RJbWFnZVVybCA9IHRoaXMuaW1hZ2VVcmw7Cgl9LAoJd2F0Y2g6IHsKCQlyZWNvcmQ6IGFzeW5jIGZ1bmN0aW9uKG9iaikgewoJCQlsZXQgewoJCQkJZGF0YQoJCQl9ID0gYXdhaXQgdGhpcy4kZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RQYXRoICsgJ21vdmllLycgKyBvYmoubWlkKTsKCQkJdGhpcy5tb3ZpZSA9IGRhdGE7CgkJCXRoaXMuaW1hZ2VVcmwgPSB0aGlzLnJlcXVlc3RQYXRoICsgJ21vdmllcG9zdGVyLycgKyBkYXRhLnBpYzsKCQkJdGhpcy5sYXRlc3RJbWFnZVVybCA9IHRoaXMuaW1hZ2VVcmw7CgkJfQoJfSwKCW1ldGhvZHM6IHsKCQlzaG93RHJhd2VyKCkgewoJCQl0aGlzLnZpc2libGUgPSB0cnVlOwoJCX0sCgkJb25DaGFuZ2UoZGF0ZSwgZGF0ZVN0cmluZykgewoJCQl0aGlzLm1vdmllLnJlbGVhc2VUaW1lID0gZGF0ZVN0cmluZzsKCQl9LAoJCW9uQ2xvc2UoKSB7CgkJCXRoaXMudmlzaWJsZSA9IGZhbHNlOwoJCQl0aGlzLm1vZGlmeSA9IGZhbHNlOwoJCQl0aGlzLm1vdmllLnBpYyA9IHRoaXMubGF0ZXN0SW1hZ2VVcmw7CgkJCXRoaXMuaW1hZ2VVcmwgPSB0aGlzLmxhdGVzdEltYWdlVXJsOwoJCX0sCgkJYXN5bmMgb25TdWJtaXQoKSB7CgkJCXRoaXMubW92aWUuZ2VucmUgPSB0aGlzLnJlY29yZC5nZW5yZTsKCQkJbGV0IHsKCQkJCWRhdGEKCQkJfSA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCh0aGlzLnJlcXVlc3RQYXRoICsgJ21vZGlmeU1vdmllJywgdGhpcy5tb3ZpZSk7CgkJCWlmIChkYXRhLmNvZGUgPT0gMCkgewoJCQkJdGhpcy5yZWNvcmQucmVsZWFzZVRpbWUgPSB0aGlzLm1vdmllLnJlbGVhc2VUaW1lCgkJCQl0aGlzLnJlY29yZC5kaXJlY3RvcnMgPSB0aGlzLm1vdmllLmRpcmVjdG9ycwoJCQkJdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfkv67mlLnmiJDlip8nKTsKCQkJfSBlbHNlIHsKCQkJCXRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S/ruaUueWksei0pScpOwoJCQl9CgkJCXRoaXMub25DbG9zZSgpOwoJCX0sCgkJaGFuZGxlQ2hhbmdlKGluZm8pIHsKCQkJaWYgKGluZm8uZmlsZS5zdGF0dXMgPT09ICd1cGxvYWRpbmcnKSB7CgkJCQl0aGlzLnBpY2xvYWRpbmcgPSB0cnVlOwoJCQkJcmV0dXJuOwoJCQl9CgkJCWlmIChpbmZvLmZpbGUuc3RhdHVzID09PSAnZG9uZScpIHsKCQkJCS8vIOS7juWJjeerr+iOt+WPluS4iuS8oOeahCBpbWctdXJsCgkJCQlnZXRCYXNlNjQoaW5mby5maWxlLm9yaWdpbkZpbGVPYmosIGltYWdlVXJsID0+IHsKCQkJCQl0aGlzLmltYWdlVXJsID0gaW1hZ2VVcmw7CgkJCQkJdGhpcy5waWNsb2FkaW5nID0gZmFsc2U7CgkJCQl9KTsKCQkJCXRoaXMubW92aWUucGljID0gaW5mby5maWxlLnJlc3BvbnNlLmRhdGEuc3JjOwoJCQl9CgkJfSwKCQliZWZvcmVVcGxvYWQoZmlsZSkgewoJCQljb25zdCBpc0pwZ09yUG5nID0gZmlsZS50eXBlID09PSAnaW1hZ2UvanBlZycgfHwgZmlsZS50eXBlID09PSAnaW1hZ2UvcG5nJzsKCQkJaWYgKCFpc0pwZ09yUG5nKSB7CgkJCQl0aGlzLiRtZXNzYWdlLmVycm9yKCdZb3UgY2FuIG9ubHkgdXBsb2FkIEpQRyBmaWxlIScpOwoJCQl9CgkJCWNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjsKCQkJaWYgKCFpc0x0Mk0pIHsKCQkJCXRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0ltYWdlIG11c3Qgc21hbGxlciB0aGFuIDJNQiEnKTsKCQkJfQoJCQlyZXR1cm4gaXNKcGdPclBuZyAmJiBpc0x0Mk07CgkJfSwKCX0sCn07Cg=="},{"version":3,"sources":["MovieDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MovieDetail.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<p style=\"cursor: pointer; color: #18aeff;\" @click=\"showDrawer\"> 详情 </p>\r\n\t\t<a-drawer :title=\"movie?movie.name:''\" :width=\"900\" :visible=\"visible\" :body-style=\"{ paddingBottom: '80px' }\" @close=\"onClose\">\r\n\t\t\t<a-form-model :model=\"movie\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\r\n\t\t\t\t<div style=\"display: flex; justify-content: space-around;\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<a-form-model-item label=\"导演\">\r\n\t\t\t\t\t\t\t<a-input v-model=\"movie.directors\" class=\"movie_inputField\" :disabled=\"!modify\" />\r\n\t\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t\t<a-form-model-item label=\"编剧\">\r\n\t\t\t\t\t\t\t<a-input v-model=\"movie.writers\" class=\"movie_inputField\" :disabled=\"!modify\" />\r\n\t\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t\t<a-form-model-item label=\"演员\">\r\n\t\t\t\t\t\t\t<a-input v-model=\"movie.stars\" class=\"movie_inputField\" :disabled=\"!modify\" />\r\n\t\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t\t<a-form-model-item label=\"播放时长\">\r\n\t\t\t\t\t\t\t<a-input v-model=\"movie.playTime\" class=\"movie_inputField\" :disabled=\"!modify\" />\r\n\t\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t\t<a-form-model-item label=\"发行时间\">\r\n\t\t\t\t\t\t\t<a-date-picker v-model=\"movie.releaseTime\" type=\"date\" placeholder=\"Pick a date\" class=\"movie_inputField\" :disabled=\"!modify\"\r\n\t\t\t\t\t\t\t @change=\"onChange\" />\r\n\t\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a-form-model-item>\r\n\t\t\t\t\t\t<a-upload name=\"file\" list-type=\"picture-card\" class=\"poster-uploader\" :show-upload-list=\"false\" :action=\"this.$store.state.requestPath + 'uploadMoviePoster'\"\r\n\t\t\t\t\t\t :before-upload=\"beforeUpload\" @change=\"handleChange\">\r\n\t\t\t\t\t\t\t<img v-if=\"imageUrl\" :src=\"imageUrl\" style=\"width: 200px; height: 300px;\" />\r\n\t\t\t\t\t\t\t<div v-else>\r\n\t\t\t\t\t\t\t\t<a-icon :type=\"picloading ? 'loading' : 'plus'\" />\r\n\t\t\t\t\t\t\t\t<div class=\"ant-upload-text\">\r\n\t\t\t\t\t\t\t\t\t上传\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</a-upload>\r\n\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"margin: -50px 0 0 -20px;\">\r\n\t\t\t\t\t<a-form-model-item label=\"类别\">\r\n\t\t\t\t\t\t<a-checkbox-group v-model=\"record.genre\" style=\"margin:10px 0 0 20px; width: 80%;\" :disabled=\"!modify\">\r\n\t\t\t\t\t\t\t<a-row>\r\n\t\t\t\t\t\t\t\t<a-col v-for=\"(item, index) in genreList\" :span=\"5\">\r\n\t\t\t\t\t\t\t\t\t<a-checkbox :value=\"item\" :name=\"item\" style=\"vertical-align:middle;\">\r\n\t\t\t\t\t\t\t\t\t\t{{item}}\r\n\t\t\t\t\t\t\t\t\t</a-checkbox>\r\n\t\t\t\t\t\t\t\t</a-col>\r\n\t\t\t\t\t\t\t</a-row>\r\n\t\t\t\t\t\t</a-checkbox-group>\r\n\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t<a-form-model-item label=\"介绍\">\r\n\t\t\t\t\t\t<a-input v-model=\"movie.intro\" type=\"textarea\" style=\"margin-left: 10px;\" :disabled=\"!modify\" />\r\n\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t<a-form-model-item label=\"修改开关\">\r\n\t\t\t\t\t\t<a-switch v-model=\"modify\" style=\"margin-left: 10px;\" />\r\n\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t\t<a-form-model-item :wrapper-col=\"{ span: 14, offset: 4 }\">\r\n\t\t\t\t\t\t<a-button type=\"primary\" @click=\"onSubmit\" :disabled=\"!modify\">\r\n\t\t\t\t\t\t\t确定\r\n\t\t\t\t\t\t</a-button>\r\n\t\t\t\t\t\t<a-button style=\"margin-left: 30px;\" @click=\"onClose\">\r\n\t\t\t\t\t\t\t返回\r\n\t\t\t\t\t\t</a-button>\r\n\t\t\t\t\t</a-form-model-item>\r\n\t\t\t\t</div>\r\n\t\t\t</a-form-model>\r\n\t\t</a-drawer>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport {\r\n\t\tmapMutations,\r\n\t\tmapState\r\n\t} from 'vuex'\r\n\r\n\tfunction getBase64(img, callback) {\r\n\t\tconst reader = new FileReader();\r\n\t\treader.addEventListener('load', () => callback(reader.result));\r\n\t\treader.readAsDataURL(img);\r\n\t};\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['userInfo', 'requestPath'])\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tlabelCol: {\r\n\t\t\t\t\tspan: 4\r\n\t\t\t\t},\r\n\t\t\t\twrapperCol: {\r\n\t\t\t\t\tspan: 14\r\n\t\t\t\t},\r\n\t\t\t\tgenreList: ['动作', '冒险', '动画', '儿童', '喜剧', '犯罪', '纪录', '戏剧',\r\n\t\t\t\t\t'幻想', '黑色', '恐怖', '音乐', '神秘', '浪漫', '科幻', '惊悚', '战争', '西部', '其他'\r\n\t\t\t\t],\r\n\t\t\t\tpicloading: false,\r\n\t\t\t\tmodify: false,\r\n\t\t\t\tvisible: false,\r\n\t\t\t\timageUrl: '',\r\n\t\t\t\tlatestImageUrl: null,\r\n\t\t\t\tmovie: null,\r\n\t\t\t};\r\n\t\t},\r\n\t\tprops: ['record'],\r\n\t\tasync created() {\r\n\t\t\tlet {\r\n\t\t\t\tdata\r\n\t\t\t} = await this.$get(this.$store.state.requestPath + 'movie/' + this.record.mid);\r\n\t\t\tthis.movie = data;\r\n\t\t\tthis.imageUrl = this.requestPath + 'movieposter/' + data.pic;\r\n\t\t\tthis.latestImageUrl = this.imageUrl;\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\trecord: async function(obj) {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'movie/' + obj.mid);\r\n\t\t\t\tthis.movie = data;\r\n\t\t\t\tthis.imageUrl = this.requestPath + 'movieposter/' + data.pic;\r\n\t\t\t\tthis.latestImageUrl = this.imageUrl;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowDrawer() {\r\n\t\t\t\tthis.visible = true;\r\n\t\t\t},\r\n\t\t\tonChange(date, dateString) {\r\n\t\t\t\tthis.movie.releaseTime = dateString;\r\n\t\t\t},\r\n\t\t\tonClose() {\r\n\t\t\t\tthis.visible = false;\r\n\t\t\t\tthis.modify = false;\r\n\t\t\t\tthis.movie.pic = this.latestImageUrl;\r\n\t\t\t\tthis.imageUrl = this.latestImageUrl;\r\n\t\t\t},\r\n\t\t\tasync onSubmit() {\r\n\t\t\t\tthis.movie.genre = this.record.genre;\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.axios.post(this.requestPath + 'modifyMovie', this.movie);\r\n\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\tthis.record.releaseTime = this.movie.releaseTime\r\n\t\t\t\t\tthis.record.directors = this.movie.directors\r\n\t\t\t\t\tthis.$message.success('修改成功');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message.error('修改失败');\r\n\t\t\t\t}\r\n\t\t\t\tthis.onClose();\r\n\t\t\t},\r\n\t\t\thandleChange(info) {\r\n\t\t\t\tif (info.file.status === 'uploading') {\r\n\t\t\t\t\tthis.picloading = true;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (info.file.status === 'done') {\r\n\t\t\t\t\t// 从前端获取上传的 img-url\r\n\t\t\t\t\tgetBase64(info.file.originFileObj, imageUrl => {\r\n\t\t\t\t\t\tthis.imageUrl = imageUrl;\r\n\t\t\t\t\t\tthis.picloading = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.movie.pic = info.file.response.data.src;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeUpload(file) {\r\n\t\t\t\tconst isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n\t\t\t\tif (!isJpgOrPng) {\r\n\t\t\t\t\tthis.$message.error('You can only upload JPG file!');\r\n\t\t\t\t}\r\n\t\t\t\tconst isLt2M = file.size / 1024 / 1024 < 2;\r\n\t\t\t\tif (!isLt2M) {\r\n\t\t\t\t\tthis.$message.error('Image must smaller than 2MB!');\r\n\t\t\t\t}\r\n\t\t\t\treturn isJpgOrPng && isLt2M;\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n<style lang='scss'>\r\n\t.movie_inputField {\r\n\t\tmargin-left: 20px;\r\n\t\twidth: 320px;\r\n\t}\r\n\r\n\t.poster-uploader>.ant-upload {\r\n\t\twidth: 200px;\r\n\t\theight: 300px;\r\n\t}\r\n\r\n\t.ant-upload-select-picture-card i {\r\n\t\tfont-size: 16;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.ant-upload-select-picture-card .ant-upload-text {\r\n\t\tmargin-top: 8px;\r\n\t\tcolor: #666;\r\n\t}\r\n</style>\n"]}]}