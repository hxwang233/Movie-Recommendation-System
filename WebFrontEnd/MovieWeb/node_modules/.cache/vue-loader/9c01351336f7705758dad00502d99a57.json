{"remainingRequest":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\MovieAddPage.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\MovieAddPage.vue","mtime":1614249261552},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5pbnB1dEZpZWxkU3R5bGUgewoJd2lkdGg6IDMyMHB4Owp9Cg=="},{"version":3,"sources":["MovieAddPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsNA;AACA;AACA","file":"MovieAddPage.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\r\n\t<a-modal v-model=\"visible\" title=\"编辑新电影\" on-ok=\"handleOk\" :afterClose=\"handleCancel\" width=\"800px\" :dialog-style=\"{ top: '15px' }\">\r\n\t\t<template slot=\"footer\">\r\n\t\t\t<a-button key=\"back\" @click=\"handleCancel\">\r\n\t\t\t\t取消\r\n\t\t\t</a-button>\r\n\t\t\t<a-button key=\"submit\" type=\"primary\" :loading=\"buttonloading\" @click=\"handleOk\">\r\n\t\t\t\t提交\r\n\t\t\t</a-button>\r\n\t\t</template>\r\n\t\t<div>\r\n\t\t\t<a-form :form=\"form\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" hide-required-mark>\r\n\t\t\t\t<div style=\"margin-top: -10px; display: flex; justify-content: space-around;\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<a-form-item label=\"电影名\">\r\n\t\t\t\t\t\t\t<a-input class=\"inputFieldStyle\" v-decorator=\"['name', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '    电影名不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请输入电影名\" />\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"导演\">\r\n\t\t\t\t\t\t\t<a-input class=\"inputFieldStyle\" v-decorator=\"['directors', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '导演不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请输入导演\" />\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"编剧\">\r\n\t\t\t\t\t\t\t<a-input class=\"inputFieldStyle\" v-decorator=\"['writers', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '编剧不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请输入编剧\" />\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"演员\">\r\n\t\t\t\t\t\t\t<a-input class=\"inputFieldStyle\" v-decorator=\"['stars', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '演员不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请输入演员\" />\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"播放时长\">\r\n\t\t\t\t\t\t\t<a-input class=\"inputFieldStyle\" v-decorator=\"['playTime', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '播放时长不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请输入片长\" />\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"发行时间\">\r\n\t\t\t\t\t\t\t<a-date-picker type=\"date\" class=\"inputFieldStyle\" v-decorator=\"['releaseTime', {rules: [{ required: true, message: '请选择发行时间' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"选择一个日期\"  @change=\"onChange\"/>\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a-form-item>\r\n\t\t\t\t\t\t<a-upload name=\"file\" list-type=\"picture-card\" class=\"poster-uploader\" :show-upload-list=\"false\" :action=\"this.$store.state.requestPath + 'uploadMoviePoster'\"\r\n\t\t\t\t\t\t :before-upload=\"beforeUpload\" @change=\"handleChange\">\r\n\t\t\t\t\t\t\t<img v-if=\"imageUrl\" :src=\"imageUrl\" style=\"width: 200px; height: 300px;\" />\r\n\t\t\t\t\t\t\t<div v-else>\r\n\t\t\t\t\t\t\t\t<a-icon :type=\"picloading ? 'loading' : 'plus'\" />\r\n\t\t\t\t\t\t\t\t<div class=\"ant-upload-text\">\r\n\t\t\t\t\t\t\t\t\t上传\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</a-upload>\r\n\t\t\t\t\t</a-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"margin: 10px 0 0 -30px;\">\r\n\t\t\t\t\t<a-form-item label=\"类别\">\r\n\t\t\t\t\t\t<a-checkbox-group v-decorator=\"['genre']\" style=\"margin-left:20px;width: 80%;\">\r\n\t\t\t\t\t\t\t<a-checkbox :value=\"index\" :name=\"item\" v-for=\"(item, index) in genreList\" style=\"vertical-align:middle;\">\r\n\t\t\t\t\t\t\t\t{{item}}\r\n\t\t\t\t\t\t\t</a-checkbox>\r\n\t\t\t\t\t\t</a-checkbox-group>\r\n\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t<a-form-item label=\"介绍\">\r\n\t\t\t\t\t\t<a-input type=\"textarea\" style=\"margin-left: 10px;\" v-decorator=\"['intro', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '电影介绍不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t placeholder=\"请输入简介\" />\r\n\t\t\t\t\t</a-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t</a-form>\r\n\t\t</div>\r\n\t</a-modal>\r\n</template>\r\n<script>\r\n\timport {\r\n\t\tmapMutations,\r\n\t\tmapState\r\n\t} from 'vuex'\r\n\r\n\tfunction getBase64(img, callback) {\r\n\t\tconst reader = new FileReader();\r\n\t\treader.addEventListener('load', () => callback(reader.result));\r\n\t\treader.readAsDataURL(img);\r\n\t};\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['userInfo', 'requestPath'])\r\n\t\t},\r\n\t\tprops: ['visible'],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tform: this.$form.createForm(this),\r\n\t\t\t\tlabelCol: {\r\n\t\t\t\t\tspan: 4\r\n\t\t\t\t},\r\n\t\t\t\twrapperCol: {\r\n\t\t\t\t\tspan: 14\r\n\t\t\t\t},\r\n\t\t\t\timageUrl: '',\r\n\t\t\t\tnewRow: {\r\n\t\t\t\t\t\"mid\": null,\r\n\t\t\t\t\t\"name\": null,\r\n\t\t\t\t\t\"genre\": null,\r\n\t\t\t\t\t\"releaseTime\": null,\r\n\t\t\t\t\t\"directors\": null,\r\n\t\t\t\t},\r\n\t\t\t\tmovie: {\r\n\t\t\t\t\t\"name\": \"undefine\",\r\n\t\t\t\t\t\"playTime\": \"undefine\",\r\n\t\t\t\t\t\"releaseTime\": \"undefine\",\r\n\t\t\t\t\t\"genre\": \"undefine\",\r\n\t\t\t\t\t\"directors\": \"undefine\",\r\n\t\t\t\t\t\"writers\": \"undefine\",\r\n\t\t\t\t\t\"stars\": \"undefine\",\r\n\t\t\t\t\t\"intro\": null,\r\n\t\t\t\t\t\"pic\": \"default.jpg\"\r\n\t\t\t\t},\r\n\t\t\t\tpicloading: false,\r\n\t\t\t\tbuttonloading: false,\r\n\t\t\t\tgenreList: ['动作', '冒险', '动画', '儿童', '喜剧', '犯罪', '纪录', '戏剧',\r\n\t\t\t\t\t'幻想', '黑色', '恐怖', '音乐', '神秘', '浪漫', '科幻', '惊悚', '战争', '西部', '其他'\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonChange(date, dateString) {\r\n\t\t\t\tthis.movie.releaseTime = dateString;\r\n\t\t\t},\r\n\t\t\tasync handleOk(e) {\t\r\n\t\t\t\tthis.form.validateFields(async (err, values) => {\r\n\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\tthis.movie.name = values.name;\r\n\t\t\t\t\t\tthis.movie.playTime = values.playTime;\r\n\t\t\t\t\t\tthis.movie.genre = values.genre;\r\n\t\t\t\t\t\tthis.movie.intro = values.intro;\r\n\t\t\t\t\t\tthis.movie.directors = values.directors;\r\n\t\t\t\t\t\tthis.movie.writers = values.writers;\r\n\t\t\t\t\t\tthis.movie.stars = values.stars;\r\n\t\t\t\t\t\tconsole.log(this.movie);\r\n\t\t\t\t\t\tlet {\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = await this.axios.post(this.requestPath + 'addMovie', this.movie);\r\n\t\t\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\t\t\tthis.newRow.mid = data.data;\r\n\t\t\t\t\t\t\tthis.newRow.name = this.movie.name;\r\n\t\t\t\t\t\t\tthis.newRow.genre = [];\r\n\t\t\t\t\t\t\tfor (var i=0; i<this.movie.genre.length; i++){\r\n\t\t\t\t\t\t\t\tthis.newRow.genre.push(this.genreList[this.movie.genre[i]]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.newRow.releaseTime = this.movie.releaseTime;\r\n\t\t\t\t\t\t\tthis.newRow.directors = this.movie.directors;\r\n\t\t\t\t\t\t\tthis.$message.success('添加成功');\r\n\t\t\t\t\t\t\tthis.$emit('updateDataSource', this.newRow);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.$message.error('添加失败');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\t\r\n\t\t\t\tthis.buttonloading = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.$emit('updatePopWinState', false);\r\n\t\t\t\t\tthis.buttonloading = false;\r\n\t\t\t\t}, 2000);\r\n\t\t\t},\r\n\t\t\thandleCancel(e) {\r\n\t\t\t\tthis.imageUrl = null;\r\n\t\t\t\tthis.$emit('updatePopWinState', false);\r\n\t\t\t},\r\n\t\t\thandleChange(info) {\r\n\t\t\t\tif (info.file.status === 'uploading') {\r\n\t\t\t\t\tthis.picloading = true;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (info.file.status === 'done') {\r\n\t\t\t\t\t// 从前端获取上传的 img-url\r\n\t\t\t\t\tgetBase64(info.file.originFileObj, imageUrl => {\r\n\t\t\t\t\t\tthis.imageUrl = imageUrl;\r\n\t\t\t\t\t\tthis.picloading = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.movie.pic = info.file.response.data.src;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeUpload(file) {\r\n\t\t\t\tconst isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n\t\t\t\tif (!isJpgOrPng) {\r\n\t\t\t\t\tthis.$message.error('You can only upload JPG file!');\r\n\t\t\t\t}\r\n\t\t\t\tconst isLt2M = file.size / 1024 / 1024 < 2;\r\n\t\t\t\tif (!isLt2M) {\r\n\t\t\t\t\tthis.$message.error('Image must smaller than 2MB!');\r\n\t\t\t\t}\r\n\t\t\t\treturn isJpgOrPng && isLt2M;\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style lang='scss'>\r\n\t.inputFieldStyle {\r\n\t\twidth: 320px;\r\n\t}\r\n</style>\n"]}]}