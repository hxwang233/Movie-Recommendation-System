{"remainingRequest":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\AdminAddPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\AdminAddPage.vue","mtime":1614249251508},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CgltYXBNdXRhdGlvbnMsCgltYXBTdGF0ZQp9IGZyb20gJ3Z1ZXgnCgpmdW5jdGlvbiBnZXRCYXNlNjQoaW1nLCBjYWxsYmFjaykgewoJY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCXJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4gY2FsbGJhY2socmVhZGVyLnJlc3VsdCkpOwoJcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1nKTsKfTsKZXhwb3J0IGRlZmF1bHQgewoJY29tcHV0ZWQ6IHsKCQkuLi5tYXBTdGF0ZShbJ3VzZXJJbmZvJywgJ3JlcXVlc3RQYXRoJ10pCgl9LAoJcHJvcHM6IFsndmlzaWJsZScsICdhbGxBY2Nlc3NMaXN0J10sCglkYXRhKCkgewoJCXJldHVybiB7CgkJCWZvcm06IHRoaXMuJGZvcm0uY3JlYXRlRm9ybSh0aGlzKSwKCQkJbGFiZWxDb2w6IHsKCQkJCXNwYW46IDQKCQkJfSwKCQkJd3JhcHBlckNvbDogewoJCQkJc3BhbjogMTQKCQkJfSwKCQkJaW1hZ2VVcmw6ICcnLAoJCQlhZG1pbjogewoJCQkJIm5hbWUiOiBudWxsLAoJCQkJImVtYWlsIjogbnVsbCwKCQkJCSJoZWFkUGljIjogImRlZmF1bHQuanBnIiwKCQkJCSJhY2Nlc3MiOiBudWxsLAoJCQl9LAoJCQlwaWNsb2FkaW5nOiBmYWxzZSwKCQkJYnV0dG9ubG9hZGluZzogZmFsc2UsCgkJfTsKCX0sCgltZXRob2RzOiB7CgkJYXN5bmMgaGFuZGxlT2soZSkgewoJCQl0aGlzLmZvcm0udmFsaWRhdGVGaWVsZHMoYXN5bmMgKGVyciwgdmFsdWVzKSA9PiB7CgkJCQlpZiAoIWVycikgewoJCQkJCXRoaXMuYWRtaW4ubmFtZSA9IHZhbHVlcy5uYW1lOwoJCQkJCXRoaXMuYWRtaW4uZW1haWwgPSB2YWx1ZXMuZW1haWw7CgkJCQkJdGhpcy5hZG1pbi5hY2Nlc3MgPSB2YWx1ZXMuYWNjZXNzOwoJCQkJCWNvbnNvbGUubG9nKHRoaXMuYWRtaW4pOwoJCQkJCWxldCB7CgkJCQkJCWRhdGEKCQkJCQl9ID0gYXdhaXQgdGhpcy5heGlvcy5wb3N0KHRoaXMucmVxdWVzdFBhdGggKyAnYWRkQWRtaW4nLCB0aGlzLmFkbWluKTsKCQkJCQlpZiAoZGF0YS5jb2RlID09IDApIHsKCQkJCQkJdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmt7vliqDmiJDlip8nKTsKCQkJCQkJdGhpcy4kZW1pdCgndXBkYXRlRGF0YVNvdXJjZScpOwkJCQkKCQkJCQl9IGVsc2UgewoJCQkJCQl0aGlzLiRtZXNzYWdlLmVycm9yKCfmt7vliqDlpLHotKUnKTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCQkKCQkJdGhpcy5idXR0b25sb2FkaW5nID0gdHJ1ZTsKCQkJc2V0VGltZW91dCgoKSA9PiB7CgkJCQl0aGlzLiRlbWl0KCd1cGRhdGVQb3BXaW5TdGF0ZScsIGZhbHNlKTsKCQkJCXRoaXMuYnV0dG9ubG9hZGluZyA9IGZhbHNlOwoJCQl9LCAyMDAwKTsKCQl9LAoJCWhhbmRsZUNhbmNlbChlKSB7CgkJCXRoaXMuaW1hZ2VVcmwgPSBudWxsOwoJCQl0aGlzLiRlbWl0KCd1cGRhdGVQb3BXaW5TdGF0ZScsIGZhbHNlKTsKCQl9LAoJCWhhbmRsZUNoYW5nZShpbmZvKSB7CgkJCWlmIChpbmZvLmZpbGUuc3RhdHVzID09PSAndXBsb2FkaW5nJykgewoJCQkJdGhpcy5waWNsb2FkaW5nID0gdHJ1ZTsKCQkJCXJldHVybjsKCQkJfQoJCQlpZiAoaW5mby5maWxlLnN0YXR1cyA9PT0gJ2RvbmUnKSB7CgkJCQkvLyDku47liY3nq6/ojrflj5bkuIrkvKDnmoQgaW1nLXVybAoJCQkJZ2V0QmFzZTY0KGluZm8uZmlsZS5vcmlnaW5GaWxlT2JqLCBpbWFnZVVybCA9PiB7CgkJCQkJdGhpcy5pbWFnZVVybCA9IGltYWdlVXJsOwoJCQkJCXRoaXMucGljbG9hZGluZyA9IGZhbHNlOwoJCQkJfSk7CgkJCQl0aGlzLnVzZXIuaGVhZFBpYyA9IGluZm8uZmlsZS5yZXNwb25zZS5kYXRhLnNyYzsKCQkJfQoJCX0sCgkJYmVmb3JlVXBsb2FkKGZpbGUpIHsKCQkJY29uc3QgaXNKcGdPclBuZyA9IGZpbGUudHlwZSA9PT0gJ2ltYWdlL2pwZWcnIHx8IGZpbGUudHlwZSA9PT0gJ2ltYWdlL3BuZyc7CgkJCWlmICghaXNKcGdPclBuZykgewoJCQkJdGhpcy4kbWVzc2FnZS5lcnJvcignWW91IGNhbiBvbmx5IHVwbG9hZCBKUEcgZmlsZSEnKTsKCQkJfQoJCQljb25zdCBpc0x0Mk0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDI7CgkJCWlmICghaXNMdDJNKSB7CgkJCQl0aGlzLiRtZXNzYWdlLmVycm9yKCdJbWFnZSBtdXN0IHNtYWxsZXIgdGhhbiAyTUIhJyk7CgkJCX0KCQkJcmV0dXJuIGlzSnBnT3JQbmcgJiYgaXNMdDJNOwoJCX0sCgl9LAp9Cg=="},{"version":3,"sources":["AdminAddPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminAddPage.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\r\n\t<a-modal v-model=\"visible\" title=\"编辑新管理员\" on-ok=\"handleOk\" :afterClose=\"handleCancel\" width=\"800px\" :dialog-style=\"{ top: '100px' }\">\r\n\t\t<template slot=\"footer\">\r\n\t\t\t<a-button key=\"back\" @click=\"handleCancel\">\r\n\t\t\t\t取消\r\n\t\t\t</a-button>\r\n\t\t\t<a-button key=\"submit\" type=\"primary\" :loading=\"buttonloading\" @click=\"handleOk\">\r\n\t\t\t\t提交\r\n\t\t\t</a-button>\r\n\t\t</template>\r\n\t\t<div>\r\n\t\t\t<a-form :form=\"form\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" hide-required-mark>\r\n\t\t\t\t<div style=\"margin-top: -10px; display: flex; justify-content: space-around;\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<a-form-item label=\"用户名\">\r\n\t\t\t\t\t\t\t<a-input style=\"width: 300px;\" v-decorator=\"['name', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '用户名不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请输入用户名\" />\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"邮箱\">\r\n\t\t\t\t\t\t\t<a-input style=\"width: 300px;\" v-decorator=\"['email']\" placeholder=\"请输入电子邮箱\"/>\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t\t<a-form-item label=\"权限\">\r\n\t\t\t\t\t\t\t<a-checkbox-group style=\"margin: 5px 0 0 5px; width: 300px;\"  v-decorator=\"['access', {rules: [\r\n\t\t\t\t\t\t\t\t{ required: true, message: '权限不能为空' }],\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t placeholder=\"请选择权限\" >\r\n\t\t\t\t\t\t\t\t<a-checkbox :value=\"a.id\" :name=\"a.menuKey\" v-for=\"a in allAccessList\" style=\"vertical-align:middle;\">\r\n\t\t\t\t\t\t\t\t\t{{a.menuKey}}\r\n\t\t\t\t\t\t\t\t</a-checkbox>\r\n\t\t\t\t\t\t\t</a-checkbox-group>\r\n\t\t\t\t\t\t</a-form-item>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a-form-item>\r\n\t\t\t\t\t\t<a-upload name=\"file\" list-type=\"picture-card\" class=\"poster-uploader\" :show-upload-list=\"false\" :action=\"this.$store.state.requestPath + 'uploadHeadPic'\"\r\n\t\t\t\t\t\t :before-upload=\"beforeUpload\" @change=\"handleChange\">\r\n\t\t\t\t\t\t\t<img v-if=\"imageUrl\" :src=\"imageUrl\" style=\"width: 200px; height: 300px;\" />\r\n\t\t\t\t\t\t\t<div v-else>\r\n\t\t\t\t\t\t\t\t<a-icon :type=\"picloading ? 'loading' : 'plus'\" />\r\n\t\t\t\t\t\t\t\t<div class=\"ant-upload-text\">\r\n\t\t\t\t\t\t\t\t\t上传\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</a-upload>\r\n\t\t\t\t\t</a-form-item>\r\n\t\t\t\t</div>\r\n\t\t\t</a-form>\r\n\t\t</div>\r\n\t</a-modal>\r\n</template>\r\n<script>\r\n\timport {\r\n\t\tmapMutations,\r\n\t\tmapState\r\n\t} from 'vuex'\r\n\r\n\tfunction getBase64(img, callback) {\r\n\t\tconst reader = new FileReader();\r\n\t\treader.addEventListener('load', () => callback(reader.result));\r\n\t\treader.readAsDataURL(img);\r\n\t};\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['userInfo', 'requestPath'])\r\n\t\t},\r\n\t\tprops: ['visible', 'allAccessList'],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tform: this.$form.createForm(this),\r\n\t\t\t\tlabelCol: {\r\n\t\t\t\t\tspan: 4\r\n\t\t\t\t},\r\n\t\t\t\twrapperCol: {\r\n\t\t\t\t\tspan: 14\r\n\t\t\t\t},\r\n\t\t\t\timageUrl: '',\r\n\t\t\t\tadmin: {\r\n\t\t\t\t\t\"name\": null,\r\n\t\t\t\t\t\"email\": null,\r\n\t\t\t\t\t\"headPic\": \"default.jpg\",\r\n\t\t\t\t\t\"access\": null,\r\n\t\t\t\t},\r\n\t\t\t\tpicloading: false,\r\n\t\t\t\tbuttonloading: false,\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync handleOk(e) {\r\n\t\t\t\tthis.form.validateFields(async (err, values) => {\r\n\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\tthis.admin.name = values.name;\r\n\t\t\t\t\t\tthis.admin.email = values.email;\r\n\t\t\t\t\t\tthis.admin.access = values.access;\r\n\t\t\t\t\t\tconsole.log(this.admin);\r\n\t\t\t\t\t\tlet {\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = await this.axios.post(this.requestPath + 'addAdmin', this.admin);\r\n\t\t\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\t\t\tthis.$message.success('添加成功');\r\n\t\t\t\t\t\t\tthis.$emit('updateDataSource');\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$message.error('添加失败');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tthis.buttonloading = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.$emit('updatePopWinState', false);\r\n\t\t\t\t\tthis.buttonloading = false;\r\n\t\t\t\t}, 2000);\r\n\t\t\t},\r\n\t\t\thandleCancel(e) {\r\n\t\t\t\tthis.imageUrl = null;\r\n\t\t\t\tthis.$emit('updatePopWinState', false);\r\n\t\t\t},\r\n\t\t\thandleChange(info) {\r\n\t\t\t\tif (info.file.status === 'uploading') {\r\n\t\t\t\t\tthis.picloading = true;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (info.file.status === 'done') {\r\n\t\t\t\t\t// 从前端获取上传的 img-url\r\n\t\t\t\t\tgetBase64(info.file.originFileObj, imageUrl => {\r\n\t\t\t\t\t\tthis.imageUrl = imageUrl;\r\n\t\t\t\t\t\tthis.picloading = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.user.headPic = info.file.response.data.src;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeUpload(file) {\r\n\t\t\t\tconst isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n\t\t\t\tif (!isJpgOrPng) {\r\n\t\t\t\t\tthis.$message.error('You can only upload JPG file!');\r\n\t\t\t\t}\r\n\t\t\t\tconst isLt2M = file.size / 1024 / 1024 < 2;\r\n\t\t\t\tif (!isLt2M) {\r\n\t\t\t\t\tthis.$message.error('Image must smaller than 2MB!');\r\n\t\t\t\t}\r\n\t\t\t\treturn isJpgOrPng && isLt2M;\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style lang='scss'>\r\n\t.poster-uploader>.ant-upload {\r\n\t\twidth: 200px;\r\n\t\theight: 240px;\r\n\t}\r\n\r\n\t.ant-upload-select-picture-card i {\r\n\t\tfont-size: 16;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.ant-upload-select-picture-card .ant-upload-text {\r\n\t\tmargin-top: 8px;\r\n\t\tcolor: #666;\r\n\t}\r\n</style>\n"]}]}