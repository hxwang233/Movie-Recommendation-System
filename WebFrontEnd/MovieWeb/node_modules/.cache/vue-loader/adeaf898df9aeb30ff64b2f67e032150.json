{"remainingRequest":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\CommentList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\src\\components\\admin\\CommentList.vue","mtime":1614254916540},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebApplication\\WebFrontEnd\\MovieWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDb21tZW50QWRkUGFnZSBmcm9tICcuL0NvbW1lbnRBZGRQYWdlLnZ1ZScKaW1wb3J0IGxvY2FsZSBmcm9tICdhbnQtZGVzaWduLXZ1ZS9lcy9kYXRlLXBpY2tlci9sb2NhbGUvemhfQ04nOwppbXBvcnQgewoJbWFwTXV0YXRpb25zLAoJbWFwU3RhdGUKfSBmcm9tICJ2dWV4IjsKY29uc3QgY29sdW1ucyA9IFt7CgkJdGl0bGU6ICfnlKjmiLflkI0nLAoJCWRhdGFJbmRleDogJ3VzZXJOYW1lJywKCQlzY29wZWRTbG90czogewoJCQljdXN0b21SZW5kZXI6ICd1c2VyTmFtZScKCQl9LAoJfSwKCXsKCQl0aXRsZTogJ+eUteW9seWQjScsCgkJZGF0YUluZGV4OiAnbW92aWVOYW1lJywKCQl3aWR0aDogJzMwMHB4JywKCQlzY29wZWRTbG90czogewoJCQljdXN0b21SZW5kZXI6ICdtb3ZpZU5hbWUnCgkJfSwKCX0sCgl7CgkJdGl0bGU6ICfor4TorrrlhoXlrrknLAoJCWRhdGFJbmRleDogJ2NvbnRlbnQnLAoJCXNjb3BlZFNsb3RzOiB7CgkJCWN1c3RvbVJlbmRlcjogJ2NvbnRlbnQnCgkJfSwKCX0sCgl7CgkJdGl0bGU6ICfliJvlu7rml7bpl7QnLAoJCWRhdGFJbmRleDogJ2NyZWF0ZWRUaW1lJywKCX0sCgl7CgkJdGl0bGU6ICfmk43kvZwnLAoJCWRhdGFJbmRleDogJ2FjdGlvbicsCgkJc2NvcGVkU2xvdHM6IHsKCQkJY3VzdG9tUmVuZGVyOiAnYWN0aW9uJwoJCX0sCgl9LApdOwpjb2x1bW5zLmZvckVhY2goKHIpID0+IHsKCXIuYWxpZ24gPSAnY2VudGVyJwp9KTsKCmV4cG9ydCBkZWZhdWx0IHsKCWNvbXBvbmVudHM6IHsKCQlDb21tZW50QWRkUGFnZQoJfSwKCWRhdGEoKSB7CgkJcmV0dXJuIHsKCQkJbG9jYWxlLAoJCQlwYXJhbXM6IHsKCQkJCWtleTogbnVsbCwKCQkJCXN0YXJ0VGltZTogbnVsbCwKCQkJCWVuZFRpbWU6IG51bGwsCgkJCX0sCgkJCWRhdGFTb3VyY2U6IG51bGwsCgkJCXBhZ2U6IDEsCgkJCXBhZ2VTaXplOiAxMCwKCQkJZGF0YWxvYWRpbmc6IHRydWUsCgkJCXZpc2libGU6IGZhbHNlLAoJCQltb2RpZnk6IGZhbHNlLAoJCQltb2RpZnlSZWNvcmQ6IHsKCQkJCWNyZWF0ZWRUaW1lOm51bGwsCgkJCQltb2RpZnlSZWNvcmQ6bnVsbCwKCQkJfSwKCQkJbmV3Q29udGVudDogbnVsbCwKCQkJY29sdW1ucywKCQl9OwoJfSwKCWNvbXB1dGVkOiB7CgkJLi4ubWFwU3RhdGUoWydyZXF1ZXN0UGF0aCcsJ3VzZXJJbmZvJ10pCgl9LAoJYXN5bmMgY3JlYXRlZCgpIHsKCQl0aGlzLmdldEFsbENvbW1lbnQoKTsKCX0sCgltZXRob2RzOiB7CgkJYXN5bmMgZ2V0QWxsQ29tbWVudCgpIHsKCQkJdGhpcy5kYXRhbG9hZGluZyA9IHRydWU7CgkJCWlmICh0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mbykgewoJCQkJbGV0IHsKCQkJCQlkYXRhCgkJCQl9ID0gYXdhaXQgdGhpcy4kZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RQYXRoICsgJ2NvbW1lbnQnKTsKCQkJCXRoaXMuZGF0YVNvdXJjZSA9IGRhdGEuZGF0YTsKCQkJCXRoaXMuZGF0YWxvYWRpbmcgPSBmYWxzZTsKCQkJfSBlbHNlIHsKCQkJCWNvbnNvbGUubG9nKCJ1c2VySW5mbyBub3QgZm91bmQiKTsKCQkJfQoJCX0sCgkJYXN5bmMgc2VhcmNoKCkgewoJCQl0aGlzLmRhdGFsb2FkaW5nID0gdHJ1ZTsKCQkJbGV0IHsKCQkJCWRhdGEKCQkJfSA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCh0aGlzLnJlcXVlc3RQYXRoICsgJ2NvbW1lbnRfc2VsZWN0JywgdGhpcy5wYXJhbXMpOwoJCQl0aGlzLmRhdGFTb3VyY2UgPSBkYXRhLmRhdGE7CgkJCXRoaXMuZGF0YWxvYWRpbmcgPSBmYWxzZTsKCQl9LAoJCW9uQ2hhbmdlKGRhdGUsIGRhdGVTdHJpbmcpIHsKCQkJdGhpcy5wYXJhbXMuc3RhcnRUaW1lID0gZGF0ZVN0cmluZ1swXTsKCQkJdGhpcy5wYXJhbXMuZW5kVGltZSA9IGRhdGVTdHJpbmdbMV07CgkJfSwKCQlhc3luYyBjb25maXJtKGUpIHsKCQkJY29uc29sZS5sb2coJ2RlbF9jaWQ6JyArIGUpOwoJCQlsZXQgewoJCQkJZGF0YQoJCQl9ID0gYXdhaXQgdGhpcy4kZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RQYXRoICsgJ2RlbENvbW1lbnQvJyArIGUpOwoJCQlpZiAoZGF0YS5jb2RlID09IDApIHsKCQkJCXRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5YqfJyk7CgkJCQljb25zdCBkYXRhU291cmNlID0gWy4uLnRoaXMuZGF0YVNvdXJjZV07CgkJCQl0aGlzLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlLmZpbHRlcihpdGVtID0+IGl0ZW0uY2lkICE9PSBlKTsKCQkJfSBlbHNlIHsKCQkJCXRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOWksei0pScpOwoJCQl9CgkJfSwKCQlhc3luYyBoYW5kbGVPayhlKXsKCQkJaWYgKHRoaXMubmV3Q29udGVudCE9bnVsbCAmJiB0aGlzLm5ld0NvbnRlbnQhPSIiKXsJCQoJCQkJdGhpcy5tb2RpZnlSZWNvcmQuY29udGVudCA9IHRoaXMubmV3Q29udGVudDsKCQkJCWNvbnNvbGUubG9nKHRoaXMubW9kaWZ5UmVjb3JkKQoJCQkJbGV0IHsKCQkJCQlkYXRhCgkJCQl9ID0gYXdhaXQgdGhpcy5heGlvcy5wb3N0KHRoaXMucmVxdWVzdFBhdGggKyAnY29tbWVudC9tb2RpZnknLCB0aGlzLm1vZGlmeVJlY29yZCk7CgkJCQlpZihkYXRhLmNvZGUgPT0gMCl7CgkJCQkJdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfkv67mlLnmiJDlip8nKTsKCQkJCX1lbHNlewoJCQkJCXRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S/ruaUueWksei0pScpOwoJCQkJfQoJCQl9CgkJCXRoaXMubmV3Q29udGVudCA9IG51bGw7CgkJCXRoaXMubW9kaWZ5ID0gZmFsc2U7CgkJfSwKCQljYW5jZWwoZSkgewoJCQl0aGlzLm5ld0NvbnRlbnQgPSBudWxsOwoJCQl0aGlzLm1vZGlmeSA9IGZhbHNlOwoJCX0sCgkJc2hvd01vZGFsKCkgewoJCQl0aGlzLnZpc2libGUgPSB0cnVlOwoJCX0sCgkJdXBkYXRlUG9wV2luU3RhdGUoc3RhdGUpewoJCQl0aGlzLnZpc2libGUgPSBzdGF0ZTsKCQl9LAoJCWFzeW5jIHVwZGF0ZURhdGFTb3VyY2UoKXsKCQkJdGhpcy5nZXRBbGxDb21tZW50KCk7CgkJfSwKCQlzaG93TW9kaWZ5V2luZG93KHJlY29yZCl7CgkJCXRoaXMubW9kaWZ5UmVjb3JkID0gcmVjb3JkOwoJCQl0aGlzLm1vZGlmeSA9IHRydWU7CgkJfSwKCX0sCn07Cg=="},{"version":3,"sources":["CommentList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CommentList.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div>\r\n\t\t\t<a-button type=\"primary\" icon=\"plus-circle\" @click=\"showModal\">\r\n\t\t\t\t添加\r\n\t\t\t</a-button>\r\n\t\t\t<CommentAddPage :visible=\"visible\" @updatePopWinState=\"updatePopWinState\" @updateDataSource=\"updateDataSource\"></CommentAddPage>\r\n\t\t\t<div style=\"display: flex; justify-content: flex-start;\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t搜关键字：\r\n\t\t\t\t\t<a-input style=\"width:250px; margin: 20px 0 ;\" v-model=\"params.key\" placeholder=\"用户名/电影名\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"margin: 20px 0 0 25px\">\r\n\t\t\t\t\t评论时间区间：\r\n\t\t\t\t\t<a-range-picker @change=\"onChange\" style=\"width:250px; \" :locale=\"locale\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<a-button type=\"primary\" icon=\"search\" style=\"margin: 20px 0 0 50px\" @click=\"search\">\r\n\t\t\t\t\t搜索\r\n\t\t\t\t</a-button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<a-table :columns=\"columns\" :data-source=\"dataSource\" :loading=\"dataloading\" :pagination=\" {pageSize:pageSize}\"\r\n\t\t\t :scroll=\"{ y: 360 }\">\r\n\t\t\t\t<b slot=\"userName\" slot-scope=\"text\">{{ text }}</b>\r\n\t\t\t\t<b slot=\"movieName\" slot-scope=\"text\">{{ text }}</b>\r\n\t\t\t\t<span slot=\"content\" slot-scope=\"text, record\">\r\n\t\t\t\t\t<a-popover placement=\"bottom\">\r\n\t\t\t\t\t\t<template slot=\"content\">\r\n\t\t\t\t\t\t\t{{record.content}}\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<div v-limit=\"[record.content,8]\" v-text=\"record.content\"></div>\r\n\t\t\t\t\t</a-popover>\r\n\t\t\t\t</span> \r\n\t\t\t\t<span slot=\"action\" slot-scope=\"text, record\">\r\n\t\t\t\t\t<div style=\"display: flex; justify-content: center;\">\r\n\t\t\t\t\t\t<a-popconfirm title=\"是否确定删除？\" ok-text=\"是\" cancel-text=\"否\" @confirm=\"confirm(record.cid)\" @cancel=\"cancel\">\r\n\t\t\t\t\t\t\t<a>删除</a>\r\n\t\t\t\t\t\t</a-popconfirm>\r\n\t\t\t\t\t\t<a-divider type=\"vertical\" v-if=\"record.userName == userInfo.name\"/>\r\n\t\t\t\t\t\t<p style=\"cursor: pointer; color: #18aeff;\" @click=\"showModifyWindow(record)\" v-if=\"record.userName == userInfo.name\"> 修改 </p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</span>\r\n\t\t\t</a-table>\r\n\t\t\t<a-modal v-model=\"modify\" title=\"修改评论\" @ok=\"handleOk\" :afterClose=\"cancel\">\r\n\t\t\t      <p>评论时间：{{modifyRecord.createdTime}}</p>\r\n\t\t\t      <p>原评论：{{modifyRecord.content}}</p>\r\n\t\t\t      <p>修改为：</p>\r\n\t\t\t\t  <a-input type=\"textarea\" v-model=\"newContent\"/>\r\n\t\t\t</a-modal>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport CommentAddPage from './CommentAddPage.vue'\r\n\timport locale from 'ant-design-vue/es/date-picker/locale/zh_CN';\r\n\timport {\r\n\t\tmapMutations,\r\n\t\tmapState\r\n\t} from \"vuex\";\r\n\tconst columns = [{\r\n\t\t\ttitle: '用户名',\r\n\t\t\tdataIndex: 'userName',\r\n\t\t\tscopedSlots: {\r\n\t\t\t\tcustomRender: 'userName'\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: '电影名',\r\n\t\t\tdataIndex: 'movieName',\r\n\t\t\twidth: '300px',\r\n\t\t\tscopedSlots: {\r\n\t\t\t\tcustomRender: 'movieName'\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: '评论内容',\r\n\t\t\tdataIndex: 'content',\r\n\t\t\tscopedSlots: {\r\n\t\t\t\tcustomRender: 'content'\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: '创建时间',\r\n\t\t\tdataIndex: 'createdTime',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: '操作',\r\n\t\t\tdataIndex: 'action',\r\n\t\t\tscopedSlots: {\r\n\t\t\t\tcustomRender: 'action'\r\n\t\t\t},\r\n\t\t},\r\n\t];\r\n\tcolumns.forEach((r) => {\r\n\t\tr.align = 'center'\r\n\t});\r\n\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tCommentAddPage\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tlocale,\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tkey: null,\r\n\t\t\t\t\tstartTime: null,\r\n\t\t\t\t\tendTime: null,\r\n\t\t\t\t},\r\n\t\t\t\tdataSource: null,\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\tdataloading: true,\r\n\t\t\t\tvisible: false,\r\n\t\t\t\tmodify: false,\r\n\t\t\t\tmodifyRecord: {\r\n\t\t\t\t\tcreatedTime:null,\r\n\t\t\t\t\tmodifyRecord:null,\r\n\t\t\t\t},\r\n\t\t\t\tnewContent: null,\r\n\t\t\t\tcolumns,\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['requestPath','userInfo'])\r\n\t\t},\r\n\t\tasync created() {\r\n\t\t\tthis.getAllComment();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync getAllComment() {\r\n\t\t\t\tthis.dataloading = true;\r\n\t\t\t\tif (this.$store.state.userInfo) {\r\n\t\t\t\t\tlet {\r\n\t\t\t\t\t\tdata\r\n\t\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'comment');\r\n\t\t\t\t\tthis.dataSource = data.data;\r\n\t\t\t\t\tthis.dataloading = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log(\"userInfo not found\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync search() {\r\n\t\t\t\tthis.dataloading = true;\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.axios.post(this.requestPath + 'comment_select', this.params);\r\n\t\t\t\tthis.dataSource = data.data;\r\n\t\t\t\tthis.dataloading = false;\r\n\t\t\t},\r\n\t\t\tonChange(date, dateString) {\r\n\t\t\t\tthis.params.startTime = dateString[0];\r\n\t\t\t\tthis.params.endTime = dateString[1];\r\n\t\t\t},\r\n\t\t\tasync confirm(e) {\r\n\t\t\t\tconsole.log('del_cid:' + e);\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await this.$get(this.$store.state.requestPath + 'delComment/' + e);\r\n\t\t\t\tif (data.code == 0) {\r\n\t\t\t\t\tthis.$message.success('删除成功');\r\n\t\t\t\t\tconst dataSource = [...this.dataSource];\r\n\t\t\t\t\tthis.dataSource = dataSource.filter(item => item.cid !== e);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message.error('删除失败');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync handleOk(e){\r\n\t\t\t\tif (this.newContent!=null && this.newContent!=\"\"){\t\t\r\n\t\t\t\t\tthis.modifyRecord.content = this.newContent;\r\n\t\t\t\t\tconsole.log(this.modifyRecord)\r\n\t\t\t\t\tlet {\r\n\t\t\t\t\t\tdata\r\n\t\t\t\t\t} = await this.axios.post(this.requestPath + 'comment/modify', this.modifyRecord);\r\n\t\t\t\t\tif(data.code == 0){\r\n\t\t\t\t\t\tthis.$message.success('修改成功');\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.$message.error('修改失败');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.newContent = null;\r\n\t\t\t\tthis.modify = false;\r\n\t\t\t},\r\n\t\t\tcancel(e) {\r\n\t\t\t\tthis.newContent = null;\r\n\t\t\t\tthis.modify = false;\r\n\t\t\t},\r\n\t\t\tshowModal() {\r\n\t\t\t\tthis.visible = true;\r\n\t\t\t},\r\n\t\t\tupdatePopWinState(state){\r\n\t\t\t\tthis.visible = state;\r\n\t\t\t},\r\n\t\t\tasync updateDataSource(){\r\n\t\t\t\tthis.getAllComment();\r\n\t\t\t},\r\n\t\t\tshowModifyWindow(record){\r\n\t\t\t\tthis.modifyRecord = record;\r\n\t\t\t\tthis.modify = true;\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>\n"]}]}