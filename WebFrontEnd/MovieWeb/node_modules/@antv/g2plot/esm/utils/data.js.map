{"version":3,"file":"data.js","sourceRoot":"","sources":["../../src/utils/data.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAI3C;;;;GAIG;AACH,MAAM,UAAU,iBAAiB,CAAC,IAAU,EAAE,KAAa;IACzD,UAAU;IACV,IAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,KAAY;QAC1C,IAAM,CAAC,GAAG,GAAG,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;QAC9B,OAAO,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,IAAM,MAAM,GAAG,UAAU,CAAC,KAAK,CAAC,UAAC,KAAY,IAAK,OAAA,GAAG,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,EAAxB,CAAwB,CAAC,CAAC;IAC5E,IAAM,MAAM,GAAG,UAAU,CAAC,KAAK,CAAC,UAAC,KAAY,IAAK,OAAA,GAAG,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,EAAxB,CAAwB,CAAC,CAAC;IAE5E,oFAAoF;IACpF,IAAI,MAAM,EAAE;QACV,OAAO,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;KACnB;IACD,IAAI,MAAM,EAAE;QACV,OAAO,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;KACnB;IACD,OAAO,EAAE,CAAC;AACZ,CAAC;AACD;;;;;;GAMG;AACH,MAAM,UAAU,2BAA2B,CACzC,IAAU,EACV,WAAmB,EACnB,WAAmB,EACnB,WAAmB;IAEnB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;QACxB,OAAO;YACL,KAAK,EAAE,EAAE;YACT,KAAK,EAAE,EAAE;SACV,CAAC;KACH;IAED,sBAAsB;IACtB,IAAM,KAAK,GAAG,EAAE,CAAC;IACjB,YAAY;IACZ,IAAM,QAAQ,GAAG,EAAE,CAAC;IACpB,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC;IACpB,2BAA2B;IAC3B,IAAI,CAAC,OAAO,CAAC,UAAC,KAAY;QACxB,IAAM,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC,CAAC;QAClC,IAAM,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC,CAAC;QAClC,IAAM,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC,CAAC;QAElC,cAAc;QACd,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACrB,QAAQ,CAAC,MAAM,CAAC,GAAG;gBACjB,EAAE,EAAE,EAAE,UAAU;gBAChB,IAAI,EAAE,MAAM;aACb,CAAC;SACH;QACD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACrB,QAAQ,CAAC,MAAM,CAAC,GAAG;gBACjB,EAAE,EAAE,EAAE,UAAU;gBAChB,IAAI,EAAE,MAAM;aACb,CAAC;SACH;QACD,QAAQ;QACR,KAAK,CAAC,IAAI,CAAC;YACT,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE;YAC3B,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE;YAC3B,sBAAsB;YACtB,sBAAsB;YACtB,KAAK,EAAE,MAAM;SACd,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IACH,OAAO;QACL,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC;QAC9B,KAAK,OAAA;KACN,CAAC;AACJ,CAAC","sourcesContent":["import { get, isNumber } from '@antv/util';\nimport { Data, Datum, Meta } from '../types';\nimport { NodeLinkData } from '../types/relation-data';\n\n/**\n * 查看数据是否是全负数、或者全正数\n * @param data\n * @param field\n */\nexport function adjustYMetaByZero(data: Data, field: string): Meta {\n  // 过滤出数字数据\n  const numberData = data.filter((datum: Datum) => {\n    const v = get(datum, [field]);\n    return isNumber(v) && !isNaN(v);\n  });\n\n  const gtZero = numberData.every((datum: Datum) => get(datum, [field]) >= 0);\n  const ltZero = numberData.every((datum: Datum) => get(datum, [field]) <= 0);\n\n  // 目前是增量更新，对 { min: 0, max: undefined } 进行 update({ max: 0 }) 会得到 { min: 0, max: 0 }\n  if (gtZero) {\n    return { min: 0 };\n  }\n  if (ltZero) {\n    return { max: 0 };\n  }\n  return {};\n}\n/**\n * 转换数据格式为带有节点与边的数据格式\n * @param data\n * @param sourceField\n * @param targetField\n * @param weightField\n */\nexport function transformDataToNodeLinkData(\n  data: Data,\n  sourceField: string,\n  targetField: string,\n  weightField: string\n): NodeLinkData {\n  if (!Array.isArray(data)) {\n    return {\n      nodes: [],\n      links: [],\n    };\n  }\n\n  //   const nodes = [];\n  const links = [];\n  // 先使用对象方式存储\n  const nodesMap = {};\n  let nodesIndex = -1;\n  // 数组变换成 chord layout 的数据结构\n  data.forEach((datum: Datum) => {\n    const source = datum[sourceField];\n    const target = datum[targetField];\n    const weight = datum[weightField];\n\n    // source node\n    if (!nodesMap[source]) {\n      nodesMap[source] = {\n        id: ++nodesIndex,\n        name: source,\n      };\n    }\n    if (!nodesMap[target]) {\n      nodesMap[target] = {\n        id: ++nodesIndex,\n        name: target,\n      };\n    }\n    // links\n    links.push({\n      source: nodesMap[source].id,\n      target: nodesMap[target].id,\n      // sourceName: source,\n      // targetName: target,\n      value: weight,\n    });\n  });\n  return {\n    nodes: Object.values(nodesMap),\n    links,\n  };\n}\n"]}