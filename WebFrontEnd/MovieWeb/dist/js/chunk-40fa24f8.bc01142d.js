(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40fa24f8"],{"40a7":function(e,t,a){"use strict";var r=a("41b2"),n=a.n(r),i={today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"},o={placeholder:"请选择时间"},s=o,l={lang:n()({placeholder:"请选择日期",rangePlaceholder:["开始日期","结束日期"]},i),timePickerLocale:n()({},s)};l.lang.ok="确 定";t["a"]=l},"514a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("a-button",{attrs:{type:"primary",icon:"plus-circle"},on:{click:e.showModal}},[e._v(" 添加 ")]),a("MovieAddPage",{attrs:{visible:e.visible},on:{updateDataSource:e.updateDataSource,updatePopWinState:e.updatePopWinState}}),a("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[e._v(" 搜关键字： "),a("a-input",{staticStyle:{width:"250px",margin:"20px 0"},attrs:{placeholder:"电影名/导演/编剧/演员"},model:{value:e.params.key,callback:function(t){e.$set(e.params,"key",t)},expression:"params.key"}})],1),a("div",{staticStyle:{margin:"20px 0 0 25px"}},[e._v(" 发行时间区间： "),a("a-range-picker",{staticStyle:{width:"250px"},attrs:{locale:e.locale},on:{change:e.onChange}})],1),a("a-button",{staticStyle:{margin:"20px 0 0 50px"},attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v(" 搜索 ")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.collapsed,expression:"!collapsed"}]},[e._v(" 电影类别： "),a("a-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择电影类别",allowClear:!0},model:{value:e.params.genre,callback:function(t){e.$set(e.params,"genre",t)},expression:"params.genre"}},e._l(e.genreList,(function(t,r){return a("a-select-option",{attrs:{value:r}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("a-divider",{staticStyle:{color:"#999999","margin-top":"-2px"}},[a("a-icon",{attrs:{type:e.collapsed?"down-circle":"up-circle"},on:{click:function(t){e.collapsed=!e.collapsed}}}),e._v(" "+e._s(e.collapsed?"展开":"收起")+"更多选项 ")],1)],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.dataSource,loading:e.dataloading,pagination:{pageSize:e.pageSize},scroll:{y:260}},scopedSlots:e._u([{key:"name",fn:function(t){return a("b",{},[e._v(e._s(t))])}},{key:"genre",fn:function(t){return a("span",{},e._l(t,(function(t){return a("a-tag",{key:t,attrs:{color:"#"+Math.random().toString(16).substr(2,6).toUpperCase()}},[e._v(" "+e._s(t.toUpperCase())+" ")])})),1)}},{key:"action",fn:function(t,r){return a("span",{},[a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("a-popconfirm",{attrs:{title:"是否确定删除？","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.confirm(r.mid)},cancel:e.cancel}},[a("a",[e._v("删除")])]),a("a-divider",{attrs:{type:"vertical"}}),a("router-view",{attrs:{record:r}})],1)])}}])})],1)},n=[],i=(a("99af"),a("4de4"),a("4160"),a("2909")),o=(a("96cf"),a("1da1")),s=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑新电影","on-ok":"handleOk",afterClose:e.handleCancel,width:"800px","dialog-style":{top:"15px"}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:e.handleCancel}},[e._v(" 取消 ")]),a("a-button",{key:"submit",attrs:{type:"primary",loading:e.buttonloading},on:{click:e.handleOk}},[e._v(" 提交 ")])],1),a("div",[a("a-form",{attrs:{form:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,"hide-required-mark":""}},[a("div",{staticStyle:{"margin-top":"-10px",display:"flex","justify-content":"space-around"}},[a("div",[a("a-form-item",{attrs:{label:"电影名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"    电影名不能为空"}]}],expression:"['name', {rules: [\n\t\t\t\t\t\t\t{ required: true, message: '    电影名不能为空' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticClass:"inputFieldStyle",attrs:{placeholder:"请输入电影名"}})],1),a("a-form-item",{attrs:{label:"导演"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["directors",{rules:[{required:!0,message:"导演不能为空"}]}],expression:"['directors', {rules: [\n\t\t\t\t\t\t\t{ required: true, message: '导演不能为空' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticClass:"inputFieldStyle",attrs:{placeholder:"请输入导演"}})],1),a("a-form-item",{attrs:{label:"编剧"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["writers",{rules:[{required:!0,message:"编剧不能为空"}]}],expression:"['writers', {rules: [\n\t\t\t\t\t\t\t{ required: true, message: '编剧不能为空' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticClass:"inputFieldStyle",attrs:{placeholder:"请输入编剧"}})],1),a("a-form-item",{attrs:{label:"演员"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["stars",{rules:[{required:!0,message:"演员不能为空"}]}],expression:"['stars', {rules: [\n\t\t\t\t\t\t\t{ required: true, message: '演员不能为空' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticClass:"inputFieldStyle",attrs:{placeholder:"请输入演员"}})],1),a("a-form-item",{attrs:{label:"播放时长"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["playTime",{rules:[{required:!0,message:"播放时长不能为空"}]}],expression:"['playTime', {rules: [\n\t\t\t\t\t\t\t{ required: true, message: '播放时长不能为空' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticClass:"inputFieldStyle",attrs:{placeholder:"请输入片长"}})],1),a("a-form-item",{attrs:{label:"发行时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["releaseTime",{rules:[{required:!0,message:"请选择发行时间"}]}],expression:"['releaseTime', {rules: [{ required: true, message: '请选择发行时间' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticClass:"inputFieldStyle",attrs:{type:"date",placeholder:"选择一个日期"},on:{change:e.onChange}})],1)],1),a("a-form-item",[a("a-upload",{staticClass:"poster-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:this.$store.state.requestPath+"uploadMoviePoster","before-upload":e.beforeUpload},on:{change:e.handleChange}},[e.imageUrl?a("img",{staticStyle:{width:"200px",height:"300px"},attrs:{src:e.imageUrl}}):a("div",[a("a-icon",{attrs:{type:e.picloading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(" 上传 ")])],1)])],1)],1),a("div",{staticStyle:{margin:"10px 0 0 -30px"}},[a("a-form-item",{attrs:{label:"类别"}},[a("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["genre"],expression:"['genre']"}],staticStyle:{"margin-left":"20px",width:"80%"}},e._l(e.genreList,(function(t,r){return a("a-checkbox",{staticStyle:{"vertical-align":"middle"},attrs:{value:r,name:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"介绍"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{rules:[{required:!0,message:"电影介绍不能为空"}]}],expression:"['intro', {rules: [\n\t\t\t\t\t\t\t{ required: true, message: '电影介绍不能为空' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]"}],staticStyle:{"margin-left":"10px"},attrs:{type:"textarea",placeholder:"请输入简介"}})],1)],1)])],1)],2)},c=[],u=(a("b0c0"),a("2f62"));function d(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}var m={computed:Object(s["a"])({},Object(u["c"])(["userInfo","requestPath"])),props:["visible"],data:function(){return{form:this.$form.createForm(this),labelCol:{span:4},wrapperCol:{span:14},imageUrl:"",newRow:{mid:null,name:null,genre:null,releaseTime:null,directors:null},movie:{name:"undefine",playTime:"undefine",releaseTime:"undefine",genre:"undefine",directors:"undefine",writers:"undefine",stars:"undefine",intro:null,pic:"default.jpg"},picloading:!1,buttonloading:!1,genreList:["动作","冒险","动画","儿童","喜剧","犯罪","纪录","戏剧","幻想","黑色","恐怖","音乐","神秘","浪漫","科幻","惊悚","战争","西部","其他"]}},methods:{onChange:function(e,t){this.movie.releaseTime=t},handleOk:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.form.validateFields(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(a,r){var n,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a){e.next=14;break}return t.movie.name=r.name,t.movie.playTime=r.playTime,t.movie.genre=r.genre,t.movie.intro=r.intro,t.movie.directors=r.directors,t.movie.writers=r.writers,t.movie.stars=r.stars,console.log(t.movie),e.next=11,t.axios.post(t.requestPath+"addMovie",t.movie);case 11:if(n=e.sent,i=n.data,0==i.code){for(t.newRow.mid=i.data,t.newRow.name=t.movie.name,t.newRow.genre=[],o=0;o<t.movie.genre.length;o++)t.newRow.genre.push(t.genreList[t.movie.genre[o]]);t.newRow.releaseTime=t.movie.releaseTime,t.newRow.directors=t.movie.directors,t.$message.success("添加成功"),t.$emit("updateDataSource",t.newRow)}else t.$message.error("添加失败");case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),t.buttonloading=!0,setTimeout((function(){t.$emit("updatePopWinState",!1),t.buttonloading=!1}),2e3);case 3:case"end":return e.stop()}}),e)})))()},handleCancel:function(e){this.imageUrl=null,this.$emit("updatePopWinState",!1)},handleChange:function(e){var t=this;"uploading"!==e.file.status?"done"===e.file.status&&(d(e.file.originFileObj,(function(e){t.imageUrl=e,t.picloading=!1})),this.movie.pic=e.file.response.data.src):this.picloading=!0},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("You can only upload JPG file!");var a=e.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),t&&a}}},p=m,v=(a("69c2"),a("2877")),f=Object(v["a"])(p,l,c,!1,null,null,null),g=f.exports,h=a("40a7"),w=[{title:"电影名",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"发行时间",dataIndex:"releaseTime"},{title:"导演",dataIndex:"directors"},{title:"类别",dataIndex:"genre",scopedSlots:{customRender:"genre"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}];w.forEach((function(e){e.align="center"}));var b={components:{MovieAddPage:g},data:function(){return{locale:h["a"],params:{key:null,startTime:null,endTime:null,genre:null},dataSource:null,page:1,pageSize:10,dataloading:!0,visible:!1,columns:w,collapsed:!0,genreList:["动作","冒险","动画","儿童","喜剧","犯罪","纪录","戏剧","幻想","黑色","恐怖","音乐","神秘","浪漫","科幻","惊悚","战争","西部","其他"]}},computed:Object(s["a"])({},Object(u["c"])(["requestPath"])),created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getAllMovie();case 1:case"end":return t.stop()}}),t)})))()},methods:{getAllMovie:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.dataloading=!0,!e.$store.state.userInfo){t.next=10;break}return t.next=4,e.$get(e.$store.state.requestPath+"allMovies");case 4:a=t.sent,r=a.data,e.dataSource=r.data,e.dataloading=!1,t.next=11;break;case 10:console.log("userInfo not found");case 11:case"end":return t.stop()}}),t)})))()},search:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dataloading=!0,t.next=3,e.axios.post(e.requestPath+"admin_select",e.params);case 3:a=t.sent,r=a.data,e.dataSource=r.data,e.dataloading=!1;case 7:case"end":return t.stop()}}),t)})))()},onChange:function(e,t){this.params.startTime=t[0],this.params.endTime=t[1]},confirm:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("del_mid:"+e),a.next=3,t.$get(t.$store.state.requestPath+"delMovie/"+e);case 3:r=a.sent,n=r.data,0==n.code?(t.$message.success("删除成功"),o=Object(i["a"])(t.dataSource),t.dataSource=o.filter((function(t){return t.mid!==e}))):t.$message.error("删除失败");case 6:case"end":return a.stop()}}),a)})))()},cancel:function(e){console.log(e)},showModal:function(){this.visible=!0},updatePopWinState:function(e){this.visible=e},updateDataSource:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(e),r=t.dataSource,t.dataSource=[].concat(Object(i["a"])(r),[e]),t.getAllMovie();case 4:case"end":return a.stop()}}),a)})))()}}},x=b,y=Object(v["a"])(x,r,n,!1,null,null,null);t["default"]=y.exports},"63df":function(e,t,a){},"69c2":function(e,t,a){"use strict";a("63df")},"99af":function(e,t,a){"use strict";var r=a("23e7"),n=a("d039"),i=a("e8b5"),o=a("861d"),s=a("7b0b"),l=a("50c4"),c=a("8418"),u=a("65f0"),d=a("1dde"),m=a("b622"),p=a("2d00"),v=m("isConcatSpreadable"),f=9007199254740991,g="Maximum allowed index exceeded",h=p>=51||!n((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),w=d("concat"),b=function(e){if(!o(e))return!1;var t=e[v];return void 0!==t?!!t:i(e)},x=!h||!w;r({target:"Array",proto:!0,forced:x},{concat:function(e){var t,a,r,n,i,o=s(this),d=u(o,0),m=0;for(t=-1,r=arguments.length;t<r;t++)if(i=-1===t?o:arguments[t],b(i)){if(n=l(i.length),m+n>f)throw TypeError(g);for(a=0;a<n;a++,m++)a in i&&c(d,m,i[a])}else{if(m>=f)throw TypeError(g);c(d,m++,i)}return d.length=m,d}})}}]);
//# sourceMappingURL=chunk-40fa24f8.bc01142d.js.map